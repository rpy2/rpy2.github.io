
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Low-level interface &#8212; rpy2 3.0.0-dev documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.0.0-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Memory management and garbage collection" href="rinterface-memorymanagement.html" />
    <link rel="prev" title="Numpy" href="numpy.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rinterface-memorymanagement.html" title="Memory management and garbage collection"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="numpy.html" title="Numpy"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">rpy2 3.0.0-dev documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-rpy2.rinterface"></span><div class="section" id="low-level-interface">
<h1>Low-level interface<a class="headerlink" href="#low-level-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The package <code class="xref py py-mod docutils literal"><span class="pre">rinterface</span></code> is provided as a lower-level interface,
for situations where either the use-cases addressed by <code class="xref py py-mod docutils literal"><span class="pre">robjects</span></code>
are not covered, or for the cases where the layer in <code class="xref py py-mod docutils literal"><span class="pre">robjects</span></code>
has an excessive cost in terms of performance.</p>
<p>The package can be imported with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">rpy2.rinterface</span> <span class="k">as</span> <span class="nn">rinterface</span>
</pre></div>
</div>
<div class="section" id="initialization">
<span id="index-0"></span><h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<p>One has to initialize R before much can be done.
The function <a class="reference internal" href="#rpy2.rinterface.initr" title="rpy2.rinterface.initr"><code class="xref py py-func docutils literal"><span class="pre">initr()</span></code></a> lets one initialize
the embedded R.</p>
<p>This is done with the function <a class="reference internal" href="#rpy2.rinterface.initr" title="rpy2.rinterface.initr"><code class="xref py py-meth docutils literal"><span class="pre">initr()</span></code></a>.</p>
<dl class="function">
<dt id="rpy2.rinterface.initr">
<code class="descclassname">rpy2.rinterface.</code><code class="descname">initr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/rpy2/rinterface.html#initr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rpy2.rinterface.initr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rinterface</span><span class="o">.</span><span class="n">initr</span><span class="p">()</span>
</pre></div>
</div>
<p>Initialization should only be performed once.
To avoid unpredictable results when using the embedded R,
subsequent calls to <a class="reference internal" href="#rpy2.rinterface.initr" title="rpy2.rinterface.initr"><code class="xref py py-func docutils literal"><span class="pre">initr()</span></code></a> will not have any effect.</p>
<p>The functions <code class="xref py py-func docutils literal"><span class="pre">get_initoptions()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">set_initoptions()</span></code>
can be used to modify the options.
Default parameters for the initialization are otherwise
in the module variable <cite>initoptions</cite>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Currently the set of default initialization option contains <cite>–vanilla</cite>,
which implies that <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal"><span class="pre">R_LIBS</span></code>, whenever set, is ignored.
The initialization options will have to be set _before_ the <strong class="program">R</strong>
is started.</p>
<p>This can be achieved very simply by added the following lines before initializing
the embedded R, or importing <a class="reference internal" href="robjects.html#module-rpy2.robjects" title="rpy2.robjects: High-level interface with R (Unix, Windows)"><code class="xref py py-mod docutils literal"><span class="pre">rpy2.robjects</span></code></a> as this action performs an initialization.</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.rinterface</span>
<span class="n">rpy2</span><span class="o">.</span><span class="n">rinterface</span><span class="o">.</span><span class="n">set_initoptions</span><span class="p">((</span><span class="s1">&#39;rpy2&#39;</span><span class="p">,</span> <span class="s1">&#39;--verbose&#39;</span><span class="p">,</span> <span class="s1">&#39;--no-save&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="admonition note" id="index-2">
<p class="first admonition-title">Note</p>
<p>If calling <a class="reference internal" href="#rpy2.rinterface.initr" title="rpy2.rinterface.initr"><code class="xref py py-func docutils literal"><span class="pre">initr()</span></code></a> returns an error stating that
<span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal"><span class="pre">R_HOME</span></code> is not defined, you should either have the <strong class="program">R</strong> executable in
your path (<span class="target" id="index-4"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code> on unix-alikes, or <span class="target" id="index-5"></span><code class="xref std std-envvar docutils literal"><span class="pre">Path</span></code> on Microsoft Windows) or
have the environment variable <span class="target" id="index-6"></span><code class="xref std std-envvar docutils literal"><span class="pre">R_HOME</span></code> defined.</p>
<p class="last">Should the initialization fail, a mismatch between the version of the R
rpy2 was compiled against and the R rpy2 is run with should be investigated.
The variable <code class="xref py py-attr docutils literal"><span class="pre">rpy2.rinterface.R_BUILD_VERSION</span></code> contains information
about the R version rpy2 was built against.
rpy2 is relatively independent of R versions, but changes in the R C API
might cause problems.</p>
</div>
<div class="section" id="ending-r">
<h4>Ending R<a class="headerlink" href="#ending-r" title="Permalink to this headline">¶</a></h4>
<p>Ending the R process is possible, but starting it again with
<a class="reference internal" href="#rpy2.rinterface.initr" title="rpy2.rinterface.initr"><code class="xref py py-func docutils literal"><span class="pre">initr()</span></code></a> does appear to lead to an R process that is hardly usable.
For that reason, the use of <a class="reference internal" href="#rpy2.rinterface.endr" title="rpy2.rinterface.endr"><code class="xref py py-func docutils literal"><span class="pre">endr()</span></code></a> should be considered
carefully, if at all.</p>
<dl class="function">
<dt id="rpy2.rinterface.endr">
<code class="descclassname">rpy2.rinterface.</code><code class="descname">endr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.endr" title="Permalink to this definition">¶</a></dt>
<dd><p>endr(int) -&gt; None</p>
<p>Terminate an embedded R by calling the function Rf_endEmbeddedR(int fatal) in the R’s C-API. 0 (zero) seems to be be a commonly used integer when calling Rf_endEmbeddedR. Note that a terminated R cannot be restarted from the same process.</p>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When writing a GUI for R, a developper may want to either prevent a user
to call <strong class="program">R</strong> <cite>quit()</cite>, or ensure that specific code is executed
before terminating R (for example a confirmation dialog window
“do you really want to terminate ?”).
This can be done by replacing the callback <cite>cleanup</cite> with an appropriate
function (see <a class="reference internal" href="callbacks.html#rinterface-callbacks-cleanup"><span class="std std-ref">Clean up</span></a>).</p>
</div>
</div>
</div>
<div class="section" id="r-space-and-python-space">
<h3>R space and Python space<a class="headerlink" href="#r-space-and-python-space" title="Permalink to this headline">¶</a></h3>
<p>When using the RPy2 package, two realms are co-existing: R and Python.</p>
<p>The <code class="xref py py-class docutils literal"><span class="pre">Sexp_Type</span></code> objects can be considered as Python envelopes pointing
to data stored and administered in the R space.</p>
<p>R variables are existing within an embedded R workspace, and can be accessed
from Python through their python object representations.</p>
<p>We distinguish two kind of R objects: named objects and anonymous objects.
Named objects have an associated symbol in the R workspace.</p>
<div class="section" id="named-objects">
<h4>Named objects<a class="headerlink" href="#named-objects" title="Permalink to this headline">¶</a></h4>
<p>For example, the following R code is creating two objects, named <cite>x</cite> and <cite>hyp</cite>
respectively, in the <cite>global environment</cite>.
Those two objects could be accessed from Python using their names.</p>
<div class="highlight-r"><div class="highlight"><pre><span></span>x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>

hyp <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">,</span> y<span class="p">)</span> <span class="kp">sqrt</span><span class="p">(</span>x<span class="o">^</span><span class="m">2</span> <span class="o">+</span> y<span class="o">^</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Two environments are provided as <code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.SexpEnvironment</span></code></p>
<p class="rubric" id="index-7">globalenv</p>
<p>The global environment can be seen as the root (or topmost) environment,
and is in fact a list, that is a sequence, of environments.</p>
<p>When an R library (package in R’s terminology) is loaded,
is it added to the existing sequence of environments. Unless
specified, it is inserted in second position. The first position
being always attributed to the global environment.
The library is said to be attached to the current search path.</p>
<p class="rubric" id="index-8">baseenv</p>
<p>The base package has a namespace, that can be accessed as an environment.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Depending on what is in <cite>globalenv</cite> and on the attached packages, base
objects can be masked when starting the search from <cite>globalenv</cite>.
Use <cite>baseenv</cite>
when you want to be sure to access a function you know to be
in the base namespace.</p>
</div>
</div>
<div class="section" id="anonymous-objects">
<h4>Anonymous objects<a class="headerlink" href="#anonymous-objects" title="Permalink to this headline">¶</a></h4>
<p>Anonymous R objects do not have an associated symbol, yet are protected
from garbage collection.</p>
<p>Such objects can be created when using the constructor for an <cite>Sexp*</cite> class.</p>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">IntVector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>creates a fully usable R vector, but it does not have an associtated
R symbol (it is in memory, but cannot be called by name fomr R). It is
also protected from garbage collection until, until
<cite>x</cite> is deleted and the Python garbage collector destroys <cite>x</cite>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To finalize the recovery of the memory used, the R garbage collector
must be also be called. This should happen automatically while running
R code when a threshold of memory usage is reached, but it
is also possible to call explicitly both garbage collectors.
See <a class="reference internal" href="rinterface-memorymanagement.html#rinterface-memory"><span class="std std-ref">Memory management and garbage collection</span></a> for more details.</p>
</div>
</div>
</div>
<div class="section" id="pass-by-value-paradigm">
<h3>Pass-by-value paradigm<a class="headerlink" href="#pass-by-value-paradigm" title="Permalink to this headline">¶</a></h3>
<p>The root of the R language is functional, with arguments passed by value.
R is actually using tricks to lower memory usage, such as only copying an object
when needed (that is when the object is modified in a local block),
but copies of objects are nevertheless frequent. This can remain unnoticed
by a user until large objects are in use or a large number of modification
of objects are performed, in which case performance issues may appear.
An infamous example is when the column names for a matrix are changed,
bringing a system to its knees when the matrix is very large,
as the whole matrix ends up being copied.</p>
<p>On the contrary, Python is using pointer objects passed around
through function calls, and since <code class="xref py py-mod docutils literal"><span class="pre">rpy2</span></code>, is a Python-to-R interface
the Python approach was conserved.</p>
<p>Although being contrived, the example below will illustrate the point.
With R, renaming a column is like:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="c1"># create a matrix</span>
m <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> nrow <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
            dimnames <span class="o">=</span> <span class="kt">list</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span><span class="p">),</span>
                            <span class="kt">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="s">&quot;e&quot;</span><span class="p">)))</span>
<span class="c1"># rename the third column</span>
i <span class="o">&lt;-</span> <span class="m">3</span>
<span class="kp">colnames</span><span class="p">(</span>m<span class="p">)[</span>i<span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;foo&quot;</span>
</pre></div>
</div>
<p>With <a class="reference internal" href="#module-rpy2.rinterface" title="rpy2.rinterface: Low-level interface with R (Unix, Windows)"><code class="xref py py-mod docutils literal"><span class="pre">rpy2.rinterface</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import and initialize</span>
<span class="kn">import</span> <span class="nn">rpy2.rinterface</span> <span class="kn">as</span> <span class="nn">ri</span>
<span class="n">ri</span><span class="o">.</span><span class="n">initr</span><span class="p">()</span>

<span class="c1"># make a function to rename column i</span>
<span class="k">def</span> <span class="nf">rename_col_i</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">m</span><span class="o">.</span><span class="n">do_slot</span><span class="p">(</span><span class="s2">&quot;dimnames&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

<span class="c1"># create a matrix</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s2">&quot;matrix&quot;</span><span class="p">]</span>
<span class="n">rlist</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s2">&quot;list&quot;</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ri</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s2">&quot;:&quot;</span><span class="p">](</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
           <span class="n">nrow</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
           <span class="n">dimnames</span> <span class="o">=</span> <span class="n">rlist</span><span class="p">(</span><span class="n">ri</span><span class="o">.</span><span class="n">StrSexpVector</span><span class="p">((</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">)),</span>
                            <span class="n">ri</span><span class="o">.</span><span class="n">StrSexpVector</span><span class="p">((</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">))))</span>
</pre></div>
</div>
<p>Now we can check that the column names</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">do_slot</span><span class="p">(</span><span class="s2">&quot;dimnames&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;)</span>
</pre></div>
</div>
<p>And rename the third column (remembering that R vectors are 1-indexed
while Python sequences are 0-indexed).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rename_col_i</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ri</span><span class="o">.</span><span class="n">StrSexpVector</span><span class="p">((</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">do_slot</span><span class="p">(</span><span class="s2">&quot;dimnames&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(&#39;a&#39;, &#39;b&#39;, &#39;foo&#39;, &#39;d&#39;, &#39;e&#39;)</span>
</pre></div>
</div>
<p>Unlike with the R code, neither the matrix or the vector with the column names
are copied. Whenever this is not a good thing, R objects can be copied the
way Python objects are usually copied (using <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="(in Python v3.7)"><code class="xref py py-func docutils literal"><span class="pre">copy.deepcopy()</span></code></a>,
<a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">Sexp</span></code></a> implements <a class="reference internal" href="#rpy2.rinterface.Sexp.__deepcopy__" title="rpy2.rinterface.Sexp.__deepcopy__"><code class="xref py py-meth docutils literal"><span class="pre">Sexp.__deepcopy__()</span></code></a>).</p>
</div>
<div class="section" id="parsing-and-evaluating-r-code">
<h3>Parsing and evaluating R code<a class="headerlink" href="#parsing-and-evaluating-r-code" title="Permalink to this headline">¶</a></h3>
<p>The R C-level function for parsing an arbitrary string a R code is exposed
as the function <a class="reference internal" href="#rpy2.rinterface.parse" title="rpy2.rinterface.parse"><code class="xref py py-func docutils literal"><span class="pre">parse()</span></code></a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expression</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;1 + 2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting expression is a nested list of R statements.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">expression</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The R code <em>1 + 2</em> translates to an expression of length 3:
<em>+(1, 2)</em>, that is a call to the function <em>+</em> (or rather the symbol associated
with the function) with the arguments <em>1</em> and <em>2</em>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ri</span><span class="o">.</span><span class="n">str_typeint</span><span class="p">(</span><span class="n">expression</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">typeof</span><span class="p">)</span>
<span class="go">&#39;SYMSXP&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">expression</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(1.0,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">expression</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(2.0,)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The expression must be evaluated if the result from its execution
is wanted.</p>
</div>
<dl class="function">
<dt id="rpy2.rinterface.parse">
<code class="descclassname">rpy2.rinterface.</code><code class="descname">parse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>parse(string)</p>
<p>Parse a string as R code.</p>
</dd></dl>

</div>
<div class="section" id="calling-python-functions-from-r">
<h3>Calling Python functions from R<a class="headerlink" href="#calling-python-functions-from-r" title="Permalink to this headline">¶</a></h3>
<p>As could be expected from R’s functional roots,
functions are first-class objects.
This means that the use of callback functions as passed as parameters
is not seldom,
and this also means that the Python programmer has to either
be able write R code for functions as arguments, or have a way
to pass Python functions to R as genuine R functions.
That last option is becoming possible, in other words one can
write a Python function and expose it to R in such a way that
the embedded R engine can use as a regular R function.</p>
<p>As an example, let’s consider the R function
<em>optim()</em> that looks for optimal parameters for a given cost function.
The cost function should be passed in the call to <em>optim()</em> as it will be
repeatedly called as the parameter space is explored, and only Python
coding skills are necessary as the code below demonstrates it.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rpy2.robjects.vectors</span> <span class="kn">import</span> <span class="n">FloatVector</span>
<span class="kn">from</span> <span class="nn">rpy2.robjects.packages</span> <span class="kn">import</span> <span class="n">importr</span>
<span class="kn">import</span> <span class="nn">rpy2.rinterface</span> <span class="kn">as</span> <span class="nn">ri</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">importr</span><span class="p">(</span><span class="s1">&#39;stats&#39;</span><span class="p">)</span>

<span class="c1"># cost function, callable from R</span>
<span class="nd">@ri.rternalize</span>
<span class="k">def</span> <span class="nf">cost_f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># Rosenbrock Banana function as a cost function</span>
    <span class="c1"># (as in the R man page for optim())</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># starting parameters</span>
<span class="n">start_params</span> <span class="o">=</span> <span class="n">FloatVector</span><span class="p">((</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># call R&#39;s optim() with our cost funtion</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">optim</span><span class="p">(</span><span class="n">start_params</span><span class="p">,</span> <span class="n">cost_f</span><span class="p">)</span>
</pre></div>
</div>
<p>For convenience, the code example uses the higher-level interface
robjects whenever possible.</p>
<p>The lower-level function <a class="reference internal" href="#rpy2.rinterface.rternalize" title="rpy2.rinterface.rternalize"><code class="xref py py-func docutils literal"><span class="pre">rternalize()</span></code></a> will take an arbitray
Python function and return an <code class="xref py py-class docutils literal"><span class="pre">rinterface.SexpClosure</span></code> instance,
that is a object that can be used by R as a function.</p>
<dl class="function">
<dt id="rpy2.rinterface.rternalize">
<code class="descclassname">rpy2.rinterface.</code><code class="descname">rternalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/rpy2/rinterface.html#rternalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rpy2.rinterface.rternalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an arbitrary Python function and wrap it
in such a way that it can be called from the R side.</p>
</dd></dl>

</div>
</div>
<div class="section" id="interactive-features">
<h2>Interactive features<a class="headerlink" href="#interactive-features" title="Permalink to this headline">¶</a></h2>
<p>The embedded R started from <code class="xref py py-mod docutils literal"><span class="pre">rpy2</span></code> is interactive by default, which
means that a number of interactive features present when working
in an interactive R console will be available for use.</p>
<p>Such features can be called explicitly by the <code class="xref py py-mod docutils literal"><span class="pre">rpy2</span></code> user, but
can also be triggered indirectly, as some on the R functions will behave
differently when run interactively compared to when run in the so-called
<em>BATCH mode</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">However, interactive use may mean the ability to periodically check
and process events. This is for example the case with interactive
graphics devices or with the HTML-based help system
(see <a class="reference internal" href="#rinterface-interactive-processevents"><span class="std std-ref">Processing interactive events</span></a>).</p>
</div>
<div class="section" id="i-o-with-the-r-console">
<h3>I/O with the R console<a class="headerlink" href="#i-o-with-the-r-console" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="callbacks.html#rinterface-callbacks-consoleio"><span class="std std-ref">Console I/O</span></a>.</p>
</div>
<div class="section" id="processing-interactive-events">
<span id="rinterface-interactive-processevents"></span><h3>Processing interactive events<a class="headerlink" href="#processing-interactive-events" title="Permalink to this headline">¶</a></h3>
<p>An interactive R session is can start interactive activities
that require a continuous monitoring for events. A typical example
is the interactive graphical devices (<cite>plotting windows</cite>),
as they can be resized and the information they display is refreshed.</p>
<p>However, to do so the R process must be instructed to process
pending interactive events. This is done by the R console for example,
but <code class="xref py py-mod docutils literal"><span class="pre">rpy2</span></code> is designed as a library rather than a threaded R process
running within Python (yet this can be done as shown below).</p>
<p>The way to restore interactivity is to simply call the function
<code class="xref py py-func docutils literal"><span class="pre">rinterface.process_revents()</span></code> at regular intervals.</p>
<p>An higher-level interface is available, running the processing of
R events in a thread (see Section <a class="reference internal" href="interactive.html#interactive-reventloop"><span class="std std-ref">R event loop</span></a>).</p>
</div>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sexp">
<h3><a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">Sexp</span></code></a><a class="headerlink" href="#sexp" title="Permalink to this headline">¶</a></h3>
<p>The class <a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">Sexp</span></code></a> is the base class for all R objects.</p>
<dl class="class">
<dt id="rpy2.rinterface.Sexp">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">Sexp</code><a class="headerlink" href="#rpy2.rinterface.Sexp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="rpy2.rinterface.Sexp.__sexp__">
<code class="descname">__sexp__</code><a class="headerlink" href="#rpy2.rinterface.Sexp.__sexp__" title="Permalink to this definition">¶</a></dt>
<dd><p>Python C capsule wrapping the pointer to the underlying R object (<cite>SEXP</cite>)</p>
</dd></dl>

<dl class="attribute">
<dt id="rpy2.rinterface.Sexp.named">
<code class="descname">named</code><a class="headerlink" href="#rpy2.rinterface.Sexp.named" title="Permalink to this definition">¶</a></dt>
<dd><p><strong class="program">R</strong> does not count references for its object. This method
returns the <cite>NAMED</cite> value (an integer).
See the R-extensions manual for further details.</p>
</dd></dl>

<dl class="attribute">
<dt id="rpy2.rinterface.Sexp.typeof">
<code class="descname">typeof</code><a class="headerlink" href="#rpy2.rinterface.Sexp.typeof" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal R type for the underlying R object</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">letters</span><span class="o">.</span><span class="n">typeof</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rpy2.rinterface.Sexp.__deepcopy__">
<code class="descname">__deepcopy__</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.Sexp.__deepcopy__" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a <em>deep</em> copy of the object, calling the R-API C function
c:function::<cite>Rf_duplicate()</cite> for copying the R object wrapped.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.0.3.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="rpy2.rinterface.Sexp.do_slot">
<code class="descname">do_slot</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.Sexp.do_slot" title="Permalink to this definition">¶</a></dt>
<dd><p>R objects can be given attributes. In R, the function
<em>attr</em> lets one access an object’s attribute; it is
called <a class="reference internal" href="#rpy2.rinterface.Sexp.do_slot" title="rpy2.rinterface.Sexp.do_slot"><code class="xref py py-meth docutils literal"><span class="pre">do_slot()</span></code></a> in the C interface to R.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> – string</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">instance of <a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">Sexp</span></code></a></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;matrix&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letters</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;letters&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">letters</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">do_slot</span><span class="p">(</span><span class="s2">&quot;dim&quot;</span><span class="p">)]</span>
<span class="go">[13, 2]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rpy2.rinterface.Sexp.do_slot_assign">
<code class="descname">do_slot_assign</code><span class="sig-paren">(</span><em>name</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.Sexp.do_slot_assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign value to the slot with the given name, creating the slot whenver
not already existing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – string</li>
<li><strong>value</strong> – instance of <a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">Sexp</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rpy2.rinterface.Sexp.rsame">
<code class="descname">rsame</code><span class="sig-paren">(</span><em>sexp_obj</em><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.Sexp.rsame" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell whether the underlying R object for sexp_obj is the same or not.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">boolean</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="section" id="underlying-r-object">
<h4>Underlying R object<a class="headerlink" href="#underlying-r-object" title="Permalink to this headline">¶</a></h4>
<p>The underlying R object is a pointer to a c:type::<cite>SEXPREC</cite> as defined in R’s
<cite>Rinternals.h</cite>. That object is wrapped in a c:type::<cite>SexpObj</cite> and placed in
a Python capsule.</p>
<p>The capsule is providing a relatively safe mechanism to exchange underlying
R objects between rpy2 objects.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rpy2.rinterface</span> <span class="kn">import</span> <span class="n">SexpIntVector</span><span class="p">,</span> <span class="n">SexpFloatVector</span>
<span class="n">vector1</span><span class="o">=</span><span class="n">SexpIntVector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">vector2</span><span class="o">=</span><span class="n">SexpFloatVector</span><span class="p">((</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">))</span>

<span class="n">vector1</span><span class="o">.</span><span class="n">__sexp__</span> <span class="o">=</span> <span class="n">vector2</span><span class="o">.</span><span class="n">__sexp_</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sexpvector">
<span id="index-9"></span><h3><a class="reference internal" href="#rpy2.rinterface.SexpVector" title="rpy2.rinterface.SexpVector"><code class="xref py py-class docutils literal"><span class="pre">SexpVector</span></code></a><a class="headerlink" href="#sexpvector" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id1">
<h4>Overview<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>In R all scalars are in fact vectors.
Anything like a one-value variable is a vector of
length 1.</p>
<p>To use again the constant <em>pi</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pi&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span>
<span class="go">&lt;rinterface.SexpVector - Python:0x2b20325d2660 / R:0x16d5248&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">3.1415926535897931</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>The letters of the (western) alphabet are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">letters</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;letters&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span>
<span class="go">26</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">LETTERS</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;LETTERS&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="r-types">
<h4>R types<a class="headerlink" href="#r-types" title="Permalink to this headline">¶</a></h4>
<p>R vectors all have a <cite>type</cite>, sometimes referred to in R as a <cite>mode</cite>.
This information is encoded as an integer by R, but it can sometimes be
better for human reader to be able to provide a string.</p>
<dl class="function">
<dt id="rpy2.rinterface.str_typeint">
<code class="descclassname">rpy2.rinterface.</code><code class="descname">str_typeint</code><span class="sig-paren">(</span><em>typeint</em><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.str_typeint" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string corresponding to a integer-encoded R type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>typeint</strong> – integer (as returned by <a class="reference internal" href="#rpy2.rinterface.Sexp.typeof" title="rpy2.rinterface.Sexp.typeof"><code class="xref py py-attr docutils literal"><span class="pre">Sexp.typeof</span></code></a>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/string.html#module-string" title="(in Python v3.7)">string</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="indexing">
<span id="index-10"></span><h4>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h4>
<p>The indexing is working like it would on regular <cite>Python</cite>
tuples or lists.
The indexing starts at 0 (zero), which differs from <strong class="program">R</strong>,
where indexing start at 1 (one).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <em>__getitem__</em> operator <em>[</em>
is returning a Python scalar. Casting
an <em>SexpVector</em> into a list is only a matter
of either iterating through it, or simply calling
the constructor <code class="xref py py-func docutils literal"><span class="pre">list()</span></code>.</p>
</div>
</div>
<div class="section" id="common-attributes">
<h4>Common attributes<a class="headerlink" href="#common-attributes" title="Permalink to this headline">¶</a></h4>
<p class="rubric" id="index-11">Names</p>
<p>In R, vectors can be named, that is each value in the vector
can be given a name (that is be associated a string).
The names are added to the other as an attribute (conveniently
called <cite>names</cite>), and can be accessed as such:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">)()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">option_names</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">do_slot</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">options_names</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Elements in a name vector do not have to be unique. A Python
counterpart is provided as <a class="reference internal" href="rlike.html#rpy2.rlike.container.TaggedList" title="rpy2.rlike.container.TaggedList"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rlike.container.TaggedList</span></code></a>.</p>
</div>
<p class="rubric" id="index-12">Dim and dimnames</p>
<p>In the case of an <cite>array</cite>, the names across the
respective dimensions of the object are accessible
through the slot named <cite>dimnames</cite>.</p>
<p class="rubric" id="index-13">Missing values</p>
<div class="admonition note" id="missing-values">
<p class="first admonition-title">Note</p>
<p class="last">R also has the notion of missing parameters in function calls.
This is a separate concept, and more information about are given in
Section <a class="reference internal" href="#rinterface-functions"><span class="std std-ref">Functions</span></a>.</p>
</div>
<p>In R missing the symbol <em>NA</em> represents a missing value.
The general rule that R scalars are in fact vectors applies here again,
and the following R code is creating a vector of length 1.</p>
<div class="highlight-r"><div class="highlight"><pre><span></span>x <span class="o">&lt;-</span> <span class="kc">NA</span>
</pre></div>
</div>
<p>The type of NA is logical (boolean), and one can specify a different
type with the symbols
<em>NA_character_</em>, <em>NA_integer_</em>, <em>NA_real_</em>, and <em>NA_complex_</em>.</p>
<p>In <a class="reference internal" href="#module-rpy2.rinterface" title="rpy2.rinterface: Low-level interface with R (Unix, Windows)"><code class="xref py py-mod docutils literal"><span class="pre">rpy2.rinterface</span></code></a>, the symbols can be accessed by through
<code class="xref py py-data docutils literal"><span class="pre">NA_Character</span></code>,
<code class="xref py py-data docutils literal"><span class="pre">NA_Integer</span></code>,
<code class="xref py py-data docutils literal"><span class="pre">NA_Real</span></code>.</p>
<p>Those are singleton instance from respective <em>NA&lt;something&gt;Type</em> classes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_naint</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">NAIntegerType</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_naint</span> <span class="ow">is</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">NA_Integer</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_naint</span> <span class="o">==</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">NA_Integer</span>
<span class="go">True</span>
</pre></div>
</div>
<p><em>NA</em> values can be present in vectors returned by R functions.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rinterface</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s1">&#39;as.integer&#39;</span><span class="p">](</span><span class="n">rinterface</span><span class="o">.</span><span class="n">StrSexpVector</span><span class="p">((</span><span class="s2">&quot;foo&quot;</span><span class="p">,)))[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">NA_integer_</span>
</pre></div>
</div>
<p><em>NA</em> values can have operators implemented, but the results will then
be missing values.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rinterface</span><span class="o">.</span><span class="n">NA_Integer</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">NA_integer_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rinterface</span><span class="o">.</span><span class="n">NA_Integer</span> <span class="o">*</span> <span class="mi">10</span>
<span class="go">NA_integer_</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Python functions relying on C-level implementations might not be following
the same rule for <em>NAs</em>.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">IntSexpVector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">NA_Integer</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">NA_integer_</span>
</pre></div>
</div>
</div>
<p>This should be preferred way to use R’s NA as those symbol are little
peculiar and cannot be retrieved with <code class="xref py py-meth docutils literal"><span class="pre">SexpEnvironment.get()</span></code>.</p>
<p>Those missing values can also be used with the <a class="reference internal" href="robjects.html#module-rpy2.robjects" title="rpy2.robjects: High-level interface with R (Unix, Windows)"><code class="xref py py-mod docutils literal"><span class="pre">rpy2.robjects</span></code></a> layer
and more documentation about their usage can be found there
(see <a class="reference internal" href="vector.html#robjects-missingvalues"><span class="std std-ref">Missing values</span></a>).</p>
<dl class="class">
<dt id="rpy2.rinterface.NAIntegerType">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">NAIntegerType</code><a class="headerlink" href="#rpy2.rinterface.NAIntegerType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a></p>
<p>Missing value for an integer in R.</p>
</dd></dl>

<dl class="class">
<dt id="rpy2.rinterface.NARealType">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">NARealType</code><a class="headerlink" href="#rpy2.rinterface.NARealType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a></p>
<p>Missing value for a float in R.</p>
</dd></dl>

<dl class="class">
<dt id="rpy2.rinterface.NALogicalType">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">NALogicalType</code><a class="headerlink" href="#rpy2.rinterface.NALogicalType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a></p>
<p>Missing value for a boolean in R.</p>
</dd></dl>

<dl class="class">
<dt id="rpy2.rinterface.NACharacterType">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">NACharacterType</code><a class="headerlink" href="#rpy2.rinterface.NACharacterType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a></p>
<p>Missing value for a string.</p>
</dd></dl>

<dl class="class">
<dt id="rpy2.rinterface.NAComplexType">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">NAComplexType</code><a class="headerlink" href="#rpy2.rinterface.NAComplexType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">complex</span></code></a></p>
<p>Missing value for a complex in R.</p>
</dd></dl>

<p class="rubric">Constructors</p>
<dl class="class">
<dt id="rpy2.rinterface.SexpVector">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">SexpVector</code><span class="sig-paren">(</span><em>obj</em>, <em>sexptype</em>, <em>copy</em><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.SexpVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.Sexp</span></code></a></p>
<p>R object that is a vector. R vectors start their indexing at one, while Python lists or arrays start indexing at zero.
In the hope to avoid confusion, the indexing in Python (e.g., <code class="xref py py-meth docutils literal"><span class="pre">__getitem__()</span></code> / <code class="xref py py-meth docutils literal"><span class="pre">__setitem__()</span></code>) starts at zero.</p>
<dl class="method">
<dt id="rpy2.rinterface.SexpVector.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>value</em><span class="optional">[</span>, <em>start</em><span class="optional">[</span>, <em>stop</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span> &#x2192; integer -- return first index of value.Raises ValueError if the value is not present.<a class="headerlink" href="#rpy2.rinterface.SexpVector.index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p>Convenience classes are provided to create vectors of a given type:</p>
<dl class="class">
<dt id="rpy2.rinterface.StrSexpVector">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">StrSexpVector</code><a class="headerlink" href="#rpy2.rinterface.StrSexpVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rpy2.rinterface.SexpVector" title="rpy2.rinterface.SexpVector"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.SexpVector</span></code></a></p>
<p>R vector of Python strings</p>
</dd></dl>

<dl class="class">
<dt id="rpy2.rinterface.IntSexpVector">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">IntSexpVector</code><a class="headerlink" href="#rpy2.rinterface.IntSexpVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rpy2.rinterface.SexpVector" title="rpy2.rinterface.SexpVector"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.SexpVector</span></code></a></p>
<p>R vector of integers (note: integers in R are C-int, not C-long)</p>
</dd></dl>

<dl class="class">
<dt id="rpy2.rinterface.FloatSexpVector">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">FloatSexpVector</code><a class="headerlink" href="#rpy2.rinterface.FloatSexpVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rpy2.rinterface.SexpVector" title="rpy2.rinterface.SexpVector"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.SexpVector</span></code></a></p>
<p>R vector of Python floats (note: double in C)</p>
</dd></dl>

<dl class="class">
<dt id="rpy2.rinterface.BoolSexpVector">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">BoolSexpVector</code><a class="headerlink" href="#rpy2.rinterface.BoolSexpVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rpy2.rinterface.SexpVector" title="rpy2.rinterface.SexpVector"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.SexpVector</span></code></a></p>
<p>R vector of booleans</p>
</dd></dl>

</div>
</div>
<div class="section" id="sexpenvironment">
<span id="rinterface-sexpenvironment"></span><span id="index-14"></span><h3><code class="xref py py-class docutils literal"><span class="pre">SexpEnvironment</span></code><a class="headerlink" href="#sexpenvironment" title="Permalink to this headline">¶</a></h3>
<div class="section" id="getitem-setitem-delitem">
<h4><code class="xref py py-meth docutils literal"><span class="pre">__getitem__()</span></code> / <code class="xref py py-meth docutils literal"><span class="pre">__setitem__()</span></code> / <code class="xref py py-meth docutils literal"><span class="pre">__delitem__()</span></code><a class="headerlink" href="#getitem-setitem-delitem" title="Permalink to this headline">¶</a></h4>
<p>The <em>[</em> operator will only look for a symbol in the environment
without looking further in the path of enclosing environments.</p>
<p>The following will return an exception <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#LookupError" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">LookupError</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="p">[</span><span class="s2">&quot;pi&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>The constant <em>pi</em> is defined in R’s <em>base</em> package,
and therefore cannot be found in the Global Environment.</p>
<p>The assignment of a value to a symbol in an environment is as
simple as assigning a value to a key in a Python dictionary:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">IntSexpVector</span><span class="p">([</span><span class="mi">123</span><span class="p">,</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="p">)</span>
<span class="go">(&#39;x&#39;, )</span>
</pre></div>
</div>
<p>Removing an element can be done like one would do it for a Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span><span class="p">(</span><span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Not all R environment are hash tables, and this may
influence performances when doing repeated lookups</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">a copy of the R object is made in the R space.</p>
</div>
</div>
<div class="section" id="iter">
<h4><code class="xref py py-meth docutils literal"><span class="pre">__iter__()</span></code><a class="headerlink" href="#iter" title="Permalink to this headline">¶</a></h4>
<p>The object is made iter-able.</p>
<p>For example, we take the base name space (that is the environment
that contains R’s base objects:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">base</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">baseenv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basetypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">typeof</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">base</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the current implementation the content of the environment
is evaluated only once, when the iterator is created. Adding
or removing elements to the environment will not update the iterator
(this is a problem, that will be solved in the near future).</p>
</div>
</div>
<div class="section" id="get">
<h4><code class="xref py py-meth docutils literal"><span class="pre">get()</span></code><a class="headerlink" href="#get" title="Permalink to this headline">¶</a></h4>
<p>Whenever a search for a symbol is performed, the whole
search path is considered: the environments in the list
are inspected in sequence and the value for the first symbol found
matching is returned.</p>
<p>Let’s start with an example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pi&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">3.1415926535897931</span>
</pre></div>
</div>
<p>The constant <cite>pi</cite> is defined in the package <cite>base</cite>, that
is always in the search path (and in the last position, as it is
attached first). The call to <code class="xref py py-meth docutils literal"><span class="pre">get()</span></code> will
look for <cite>pi</cite> first in <cite>globalenv</cite>, then in the next environment
in the search path and repeat this until an object is found or the
sequence of environments to explore is exhausted.</p>
<p>We know that <cite>pi</cite> is in the base namespace and we could have gotten
here directly from there:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ri</span><span class="o">.</span><span class="n">baseenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pi&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">3.1415926535897931</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ri</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s2">&quot;pi&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">3.1415926535897931</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ri</span><span class="o">.</span><span class="n">globalenv</span><span class="p">[</span><span class="s2">&quot;pi&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">LookupError</span>: <span class="n">&#39;pi&#39; not found</span>
</pre></div>
</div>
<p><strong class="program">R</strong> can look specifically for functions, which is happening when
a parsed function call is evaluated.
The following example of an <strong class="program">R</strong> interactive session should demonstrate it:</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="o">&gt;</span> mydate <span class="o">&lt;-</span> <span class="s">&quot;hohoho&quot;</span>
<span class="o">&gt;</span> mydate<span class="p">()</span>
Error<span class="o">:</span> could not find <span class="kr">function</span> <span class="s">&quot;mydate&quot;</span>
<span class="o">&gt;</span>
<span class="o">&gt;</span> date <span class="o">&lt;-</span> <span class="s">&quot;hohoho&quot;</span>
<span class="o">&gt;</span> <span class="kp">date</span><span class="p">()</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;Sat Aug  9 15:27:40 2008&quot;</span>
</pre></div>
</div>
<p>The base function <cite>date</cite> is still found, although a non-function object
is present earlier on the search path.</p>
<p>The same behavior can be obtained from <code class="xref py py-mod docutils literal"><span class="pre">rpy2</span></code>
with the optional parameter <cite>wantfun</cite> (specify that <code class="xref py py-meth docutils literal"><span class="pre">get()</span></code>
should return an R function).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ri</span><span class="o">.</span><span class="n">globalenv</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">StrSexpVector</span><span class="p">([</span><span class="s2">&quot;hohoho&quot;</span><span class="p">,</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ri</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;hohoho&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ri</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">wantfun</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&lt;rinterface.SexpClosure - Python:0x7f142aa96198 / R:0x16e9500&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">date</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">wantfun</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">date</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;Sat Aug  9 15:48:42 2008&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="r-packages-as-environments">
<h4>R packages as environments<a class="headerlink" href="#r-packages-as-environments" title="Permalink to this headline">¶</a></h4>
<p>In a <cite>Python</cite> programmer’s perspective, it would be nice to map loaded <strong class="program">R</strong>
packages as modules and provide access to <strong class="program">R</strong> objects in packages the
same way than <cite>Python</cite> object in modules are accessed.</p>
<p>This is unfortunately not possible in a completely
robust way: the dot character <cite>.</cite>
can be used for symbol names in R (like pretty much any character), and
this can make an exact correspondance between <strong class="program">R</strong> and <cite>Python</cite> names
rather difficult.
<code class="xref py py-mod docutils literal"><span class="pre">rpy</span></code> uses transformation functions that translates ‘.’ to ‘_’ and back,
but this can lead to complications since ‘_’ can also be used for R symbols
(although this is the approach taken for the high-level interface, see
Section <a class="reference internal" href="robjects_rpackages.html#robjects-packages"><span class="std std-ref">R packages</span></a>).</p>
<p>There is a way to provide explict access to object in R packages, since
loaded packages can be considered as environments. To make it convenient
to use, one can consider making a function such as the one below:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rimport</span><span class="p">(</span><span class="n">packname</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; import an R package and return its environment &quot;&quot;&quot;</span>
    <span class="n">as_environment</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s1">&#39;as.environment&#39;</span><span class="p">]</span>
    <span class="n">require</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s1">&#39;require&#39;</span><span class="p">]</span>
    <span class="n">require</span><span class="p">(</span><span class="n">rinterface</span><span class="o">.</span><span class="n">StrSexpVector</span><span class="p">(</span><span class="n">packname</span><span class="p">),</span>
            <span class="n">quiet</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">BoolSexpVector</span><span class="p">((</span><span class="bp">True</span><span class="p">,</span> <span class="p">)))</span>
    <span class="n">packname</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">StrSexpVector</span><span class="p">((</span><span class="s1">&#39;package:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">packname</span><span class="p">)))</span>
    <span class="n">pack_env</span> <span class="o">=</span> <span class="n">as_environment</span><span class="p">(</span><span class="n">packname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pack_env</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">class_env</span> <span class="o">=</span> <span class="n">rimport</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">class_env</span><span class="p">[</span><span class="s1">&#39;knn&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>For example, we can reimplement in <cite>Python</cite> the <strong class="program">R</strong> function
returning the search path (<cite>search</cite>).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rsearch</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Return a list of package environments corresponding to the</span>
<span class="sd">    R search path. &quot;&quot;&quot;</span>
    <span class="n">spath</span> <span class="o">=</span> <span class="p">[</span><span class="n">ri</span><span class="o">.</span><span class="n">globalenv</span><span class="p">,</span> <span class="p">]</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">enclos</span><span class="p">()</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">rsame</span><span class="p">(</span><span class="n">ri</span><span class="o">.</span><span class="n">emptyenv</span><span class="p">):</span>
        <span class="n">spath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">enclos</span><span class="p">()</span>
    <span class="n">spath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ri</span><span class="o">.</span><span class="n">baseenv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spath</span>
</pre></div>
</div>
<p>As an other example, one can implement simply a function that
returns from which environment an object called by <code class="xref py py-meth docutils literal"><span class="pre">get()</span></code> comes
from.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">wherefrom</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">startenv</span><span class="o">=</span><span class="n">ri</span><span class="o">.</span><span class="n">globalenv</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; when calling &#39;get&#39;, where the R object is coming from. &quot;&quot;&quot;</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">startenv</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">retry</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">retry</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">env</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">retry</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">except</span> <span class="ne">LookupError</span><span class="p">,</span> <span class="n">knf</span><span class="p">:</span>
            <span class="n">env</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">enclos</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">rsame</span><span class="p">(</span><span class="n">ri</span><span class="o">.</span><span class="n">emptyenv</span><span class="p">):</span>
                <span class="n">retry</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retry</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="n">env</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wherefrom</span><span class="p">(</span><span class="s1">&#39;plot&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">do_slot</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;package:graphics&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wherefrom</span><span class="p">(</span><span class="s1">&#39;help&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">do_slot</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;package:utils&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Unfortunately this does not generalize to all cases: the base package does not have a name.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span>&gt;&gt;&gt; wherefrom(&#39;get&#39;).do_slot(&#39;name&#39;)[0]
Traceback (most recent call last):
File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
LookupError: The object has no such attribute.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="functions">
<span id="rinterface-functions"></span><span id="index-15"></span><h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<p class="rubric">A function with a context</p>
<p>In R terminology, a closure is a function (with its enclosing
environment). That enclosing environment can be thought of as
a context to the function.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Technically, the class <code class="xref py py-class docutils literal"><span class="pre">SexpClosure</span></code> corresponds to the R
types CLOSXP, BUILTINSXP, and SPECIALSXP, with only the first one
(CLOSXP) being a closure.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">IntSexpVector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">6</span>
</pre></div>
</div>
<p class="rubric">Named arguments</p>
<p>Named arguments to an R function can be specified just the way
they would be with any other regular Python function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rnorm</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rnorm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rnorm</span><span class="p">(</span><span class="n">rinterface</span><span class="o">.</span><span class="n">IntSexpVector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">]),</span>
<span class="go">          mean = rinterface.IntSexpVector([2, ]))[0]</span>
<span class="go">0.32796768001636134</span>
</pre></div>
</div>
<p>There are however frequent names for R parameters causing problems: all the names with a <em>dot</em>. using such parameters for an R function will either require
to:</p>
<ul class="simple">
<li>use the special syntax <cite>**kwargs</cite> on a dictionary with the named parameters</li>
<li>use the method <code class="xref py py-meth docutils literal"><span class="pre">rcall()</span></code>.</li>
</ul>
<p class="rubric" id="index-16">Order for named parameters</p>
<p>One point where function calls in R can differ from the ones in
Python is that
all parameters in R are passed in the order they are in the call
(no matter whether the parameter is named or not),
while in Python only parameters without a name are passed in order.
Using the class <code class="xref py py-class docutils literal"><span class="pre">OrdDict</span></code> in the module <a class="reference internal" href="rlike.html#module-rpy2.rlike.container" title="rpy2.rlike.container"><code class="xref py py-mod docutils literal"><span class="pre">rpy2.rlike.container</span></code></a>,
together with the method <code class="xref py py-meth docutils literal"><span class="pre">rcall()</span></code>,
permits calling a function the same way it would in R. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.rlike.container</span> <span class="k">as</span> <span class="nn">rpc</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">rpc</span><span class="o">.</span><span class="n">OrdDict</span><span class="p">()</span>
<span class="n">args</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">IntSexpVector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">args</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">IntSexpVector</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">args</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">IntSexpVector</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="p">])</span>
<span class="n">rlist</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s1">&#39;list&#39;</span><span class="p">]</span>
<span class="n">rl</span> <span class="o">=</span> <span class="n">rlist</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rl</span><span class="o">.</span><span class="n">do_slot</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">)]</span>
<span class="go">[&#39;x&#39;, &#39;&#39;, &#39;y&#39;]</span>
</pre></div>
</div>
<p class="rubric" id="index-17">closureEnv</p>
<p>In the example below, we inspect the environment for the
function <em>plot</em>, that is the namespace for the
package <em>graphics</em>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;plot&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ls</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">globalenv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ls&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envplot_list</span> <span class="o">=</span> <span class="n">ls</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">closureEnv</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">envplot_ls</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p class="rubric">Missing parameters</p>
<p>In R function calls can contain explicitely missing parameters.</p>
<div class="highlight-rconsole"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kp">sum</span><span class="p">(</span><span class="m">1</span><span class="p">,,</span><span class="m">3</span><span class="p">)</span>
<span class="go">Error: element 2 is empty;</span>
<span class="go">   the part of the args list of &#39;sum&#39; being evaluated was:</span>
<span class="go">   (1, , 3)</span>
</pre></div>
</div>
<p>This is used when extracting a subset of an array, with a missing
parameter interpreted by the extract function <cite>[</cite> like all elements
across that dimension must be taken.</p>
<div class="highlight-r"><div class="highlight"><pre><span></span>m <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> nrow <span class="o">=</span> <span class="m">5</span><span class="p">,</span> ncol <span class="o">=</span> <span class="m">2</span><span class="p">)</span>

<span class="c1"># extract the second column</span>
n <span class="o">&lt;-</span> m<span class="p">[,</span> <span class="m">2</span><span class="p">]</span>

<span class="c1"># can also be written</span>
n <span class="o">&lt;-</span> <span class="s">&quot;[&quot;</span><span class="p">(</span>m<span class="p">,</span> <span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-data docutils literal"><span class="pre">rinterface.MissingArg</span></code> is a pointer to the singleton <code class="xref py py-class docutils literal"><span class="pre">rinterface.MissingArgType</span></code>,
allowing to explicitly pass missing parameters to a function call.</p>
<p>For example, the extraction of the second column of a matrix with R shown above,
will write almost identically in rpy2.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.rinterface</span> <span class="kn">as</span> <span class="nn">ri</span>
<span class="n">ri</span><span class="o">.</span><span class="n">initr</span><span class="p">()</span>

<span class="n">matrix</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s1">&#39;matrix&#39;</span><span class="p">]</span>
<span class="n">extract</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">baseenv</span><span class="p">[</span><span class="s1">&#39;[&#39;</span><span class="p">]</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ri</span><span class="o">.</span><span class="n">IntSexpVector</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)),</span> <span class="n">nrow</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">ri</span><span class="o">.</span><span class="n">MissingArg</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sexps4">
<h3><a class="reference internal" href="#rpy2.rinterface.SexpS4" title="rpy2.rinterface.SexpS4"><code class="xref py py-class docutils literal"><span class="pre">SexpS4</span></code></a><a class="headerlink" href="#sexps4" title="Permalink to this headline">¶</a></h3>
<p>Object-Oriented programming in R exists in several flavours, and one
of those is called <cite>S4</cite>.
It has its own type at R’s C-API level, and because of that specificity
we defined a class. Beside that, the class does not provide much specific
features (see the pydoc for the class below).</p>
<p>An instance’s attributes can be accessed through the parent
class <a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">Sexp</span></code></a> method
<code class="xref py py-meth docutils literal"><span class="pre">do_slot()</span></code>.</p>
<dl class="class">
<dt id="rpy2.rinterface.SexpS4">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">SexpS4</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.SexpS4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.Sexp</span></code></a></p>
<p>R object that is an ‘S4 object’.Attributes can be accessed using the method ‘do_slot’.</p>
</dd></dl>

</div>
<div class="section" id="sexpextptr">
<h3><a class="reference internal" href="#rpy2.rinterface.SexpExtPtr" title="rpy2.rinterface.SexpExtPtr"><code class="xref py py-class docutils literal"><span class="pre">SexpExtPtr</span></code></a><a class="headerlink" href="#sexpextptr" title="Permalink to this headline">¶</a></h3>
<p>External pointers are intended to facilitate the handling of C or C++ data structures
from R. In few words they are pointers to structures <em>external</em> to R. They have
been used to implement vectors and arrays in shared memory, or storage-based vectors
and arrays.</p>
<p>External pointers also do not obey the pass-by-value rule and can represent a way
to implement pointers in R.</p>
<p>Let us consider the following simple example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ep</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">SexpExtPtr</span><span class="p">(</span><span class="s2">&quot;hohoho&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The Python string is now encapsulated into an R external pointer, and visible as such
by the embedded R process.</p>
<p>When thinking of sharing C-level structures between R and Python more involved examples
can be considered (here still a simple example):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ctypes</span>
<span class="k">class</span> <span class="nc">Point2D</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">)]</span>

<span class="n">pt</span> <span class="o">=</span> <span class="n">Point2D</span><span class="p">()</span>

<span class="n">ep</span> <span class="o">=</span> <span class="n">rinterface</span><span class="o">.</span><span class="n">SexpExtPtr</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
</pre></div>
</div>
<p>However, this remains a rather academic exercise unless there exists a way to access the
data from R; when used in R packages, external pointers have companion functions to
manipulate the C-level data structures.</p>
<p>In the case of external pointers and their companion functions and methods
defined by R packages, the rpy2 interface lets a programmer create such external pointers
directly from Python, using <a class="reference external" href="https://docs.python.org/3/library/ctypes.html#module-ctypes" title="(in Python v3.7)"><code class="xref py py-mod docutils literal"><span class="pre">ctypes</span></code></a> for example.</p>
<p>However, the rpy2 interface allows more than that since a programmer is able to make
a Python function accessible to R has is was a function of its own. It is possible
to define arbitrary Python data structures as well as functions or methods to operate
on them, pass the data structure to R as an external pointer, and expose the functions
and methods to R.</p>
<dl class="class">
<dt id="rpy2.rinterface.SexpExtPtr">
<em class="property">class </em><code class="descclassname">rpy2.rinterface.</code><code class="descname">SexpExtPtr</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#rpy2.rinterface.SexpExtPtr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rpy2.rinterface.Sexp" title="rpy2.rinterface.Sexp"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.Sexp</span></code></a></p>
<p>R object that is an ‘external pointer’, a pointer to a data structure implemented at the C level.
SexpExtPtr(extref, tag = None, protected = None)</p>
</dd></dl>

</div>
</div>
<div class="section" id="class-diagram">
<h2>Class diagram<a class="headerlink" href="#class-diagram" title="Permalink to this headline">¶</a></h2>
<img src="_images/inheritance-c31cb4cd3c8267a379627d91188499b755b8f60d.png" alt="Inheritance diagram of rpy2.rinterface" usemap="#inheritance422e17c3d0" class="inheritance"/>
<map id="inheritance422e17c3d0" name="inheritance422e17c3d0">
<area shape="rect" id="node1" href="#rpy2.rinterface.BoolSexpVector" target="_top" title="R vector of booleans" alt="" coords="426,104,549,129"/>
<area shape="rect" id="node2" href="#rpy2.rinterface.SexpVector" target="_top" title="R object that is a vector. R vectors start their indexing at one, while Python lists or arrays start indexing at zero." alt="" coords="227,252,322,277"/>
<area shape="rect" id="node3" title="R vector of bytes" alt="" coords="425,153,549,179"/>
<area shape="rect" id="node4" title="R vector of complex values." alt="" coords="412,203,563,228"/>
<area shape="rect" id="node5" href="#rpy2.rinterface.FloatSexpVector" target="_top" title="R vector of Python floats (note: double in C)" alt="" coords="424,252,551,277"/>
<area shape="rect" id="node6" href="#rpy2.rinterface.IntSexpVector" target="_top" title="R vector of integers (note: integers in R are C&#45;int, not C&#45;long)" alt="" coords="432,301,543,327"/>
<area shape="rect" id="node7" title="R list." alt="" coords="429,351,546,376"/>
<area shape="rect" id="node24" href="#rpy2.rinterface.StrSexpVector" target="_top" title="R vector of Python strings" alt="" coords="430,400,545,425"/>
<area shape="rect" id="node8" href="#rpy2.rinterface.NACharacterType" target="_top" title="Missing value for a string." alt="" coords="5,351,137,376"/>
<area shape="rect" id="node9" href="#rpy2.rinterface.NAComplexType" target="_top" title="Missing value for a complex in R." alt="" coords="9,301,134,327"/>
<area shape="rect" id="node10" href="#rpy2.rinterface.NAIntegerType" target="_top" title="Missing value for an integer in R." alt="" coords="14,252,129,277"/>
<area shape="rect" id="node11" href="#rpy2.rinterface.NALogicalType" target="_top" title="Missing value for a boolean in R." alt="" coords="15,203,128,228"/>
<area shape="rect" id="node12" href="#rpy2.rinterface.NARealType" target="_top" title="Missing value for a float in R." alt="" coords="24,153,119,179"/>
<area shape="rect" id="node13" title="R NULL (singleton)." alt="" coords="229,301,320,327"/>
<area shape="rect" id="node14" href="#rpy2.rinterface.Sexp" target="_top" title="Sexp" alt="" coords="35,400,107,425"/>
<area shape="rect" id="node19" title="A R object that is a closure, that is a function. In R a function is defined within an enclosing environment, thus the name closure. In Python, &#39;nested scopes&#39; could be the closest similar thing." alt="" coords="223,351,326,376"/>
<area shape="rect" id="node20" title="R object that is an environment. R environments can be seen as similar to Python dictionnaries, with the following twists:" alt="" coords="207,400,342,425"/>
<area shape="rect" id="node21" href="#rpy2.rinterface.SexpExtPtr" target="_top" title="R object that is an &#39;external pointer&#39;, a pointer to a data structure implemented at the C level." alt="" coords="229,449,321,475"/>
<area shape="rect" id="node22" href="#rpy2.rinterface.SexpS4" target="_top" title="R object that is an &#39;S4 object&#39;.Attributes can be accessed using the method &#39;do_slot&#39;." alt="" coords="239,499,311,524"/>
<area shape="rect" id="node23" title="R symbol" alt="" coords="223,548,326,573"/>
<area shape="rect" id="node15" title="Error when parsing a string as R code." alt="" coords="18,104,125,129"/>
<area shape="rect" id="node16" title="Exception raised when a string parsed asR code seems like an incomplete code block." alt="" coords="185,104,364,129"/>
</map>
</div>
<div class="section" id="misc-variables">
<h2>Misc. variables<a class="headerlink" href="#misc-variables" title="Permalink to this headline">¶</a></h2>
<dl class="docutils" id="index-18">
<dt>R_HOME</dt>
<dd>R HOME</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">R_LEN_T_MAX</span></code></dt>
<dd>largest usable integer for indexing R vectors</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">TRUE</span></code>/<code class="xref py py-const docutils literal"><span class="pre">FALSE</span></code></dt>
<dd>R’s TRUE and FALSE</dd>
</dl>
<div class="section" id="index-19">
<span id="id2"></span><h3>R types<a class="headerlink" href="#index-19" title="Permalink to this headline">¶</a></h3>
<div class="section" id="vector-types">
<h4>Vector types<a class="headerlink" href="#vector-types" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">CPLXSXP</span></code></dt>
<dd>Complex</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">INTSXP</span></code></dt>
<dd>Integer.</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">LGLSXP</span></code></dt>
<dd>Boolean (logical in the R terminology)</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">RAWSXP</span></code></dt>
<dd>Raw (bytes) value</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">REALSXP</span></code></dt>
<dd>Numerical value (float / double)</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">STRSXP</span></code></dt>
<dd>String</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">VECSXP</span></code></dt>
<dd>List</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">LISTSXP</span></code></dt>
<dd>Paired list</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">LANGSXP</span></code></dt>
<dd>Language object.</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">EXPRSXP</span></code></dt>
<dd>Unevaluated expression.</dd>
</dl>
</div>
<div class="section" id="function-types">
<h4>Function types<a class="headerlink" href="#function-types" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">CLOSXP</span></code></dt>
<dd>Function with an enclosure. Represented by <code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.SexpClosure</span></code>.</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">BUILTINSXP</span></code></dt>
<dd>Base function</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">SPECIALSXP</span></code></dt>
<dd>Some other kind of function</dd>
</dl>
</div>
<div class="section" id="other-types">
<h4>Other types<a class="headerlink" href="#other-types" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">ENVSXP</span></code></dt>
<dd>Environment. Represented by <code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.SexpEnvironment</span></code>.</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">S4SXP</span></code></dt>
<dd>Instance of class S4. Represented by <a class="reference internal" href="#rpy2.rinterface.SexpS4" title="rpy2.rinterface.SexpS4"><code class="xref py py-class docutils literal"><span class="pre">rpy2.rinterface.SexpS4</span></code></a>.</dd>
</dl>
</div>
<div class="section" id="types-one-should-not-meet">
<h4>Types one should not meet<a class="headerlink" href="#types-one-should-not-meet" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">PROMSXP</span></code></dt>
<dd>Promise.</dd>
</dl>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/rpy2_logo_64x64.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Low-level interface</a><ul>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#initialization">Initialization</a><ul>
<li><a class="reference internal" href="#ending-r">Ending R</a></li>
</ul>
</li>
<li><a class="reference internal" href="#r-space-and-python-space">R space and Python space</a><ul>
<li><a class="reference internal" href="#named-objects">Named objects</a></li>
<li><a class="reference internal" href="#anonymous-objects">Anonymous objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pass-by-value-paradigm">Pass-by-value paradigm</a></li>
<li><a class="reference internal" href="#parsing-and-evaluating-r-code">Parsing and evaluating R code</a></li>
<li><a class="reference internal" href="#calling-python-functions-from-r">Calling Python functions from R</a></li>
</ul>
</li>
<li><a class="reference internal" href="#interactive-features">Interactive features</a><ul>
<li><a class="reference internal" href="#i-o-with-the-r-console">I/O with the R console</a></li>
<li><a class="reference internal" href="#processing-interactive-events">Processing interactive events</a></li>
</ul>
</li>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#sexp"><code class="docutils literal"><span class="pre">Sexp</span></code></a><ul>
<li><a class="reference internal" href="#underlying-r-object">Underlying R object</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sexpvector"><code class="docutils literal"><span class="pre">SexpVector</span></code></a><ul>
<li><a class="reference internal" href="#id1">Overview</a></li>
<li><a class="reference internal" href="#r-types">R types</a></li>
<li><a class="reference internal" href="#indexing">Indexing</a></li>
<li><a class="reference internal" href="#common-attributes">Common attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sexpenvironment"><code class="docutils literal"><span class="pre">SexpEnvironment</span></code></a><ul>
<li><a class="reference internal" href="#getitem-setitem-delitem"><code class="docutils literal"><span class="pre">__getitem__()</span></code> / <code class="docutils literal"><span class="pre">__setitem__()</span></code> / <code class="docutils literal"><span class="pre">__delitem__()</span></code></a></li>
<li><a class="reference internal" href="#iter"><code class="docutils literal"><span class="pre">__iter__()</span></code></a></li>
<li><a class="reference internal" href="#get"><code class="docutils literal"><span class="pre">get()</span></code></a></li>
<li><a class="reference internal" href="#r-packages-as-environments">R packages as environments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#sexps4"><code class="docutils literal"><span class="pre">SexpS4</span></code></a></li>
<li><a class="reference internal" href="#sexpextptr"><code class="docutils literal"><span class="pre">SexpExtPtr</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#class-diagram">Class diagram</a></li>
<li><a class="reference internal" href="#misc-variables">Misc. variables</a><ul>
<li><a class="reference internal" href="#index-19">R types</a><ul>
<li><a class="reference internal" href="#vector-types">Vector types</a></li>
<li><a class="reference internal" href="#function-types">Function types</a></li>
<li><a class="reference internal" href="#other-types">Other types</a></li>
<li><a class="reference internal" href="#types-one-should-not-meet">Types one should not meet</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="numpy.html"
                        title="previous chapter">Numpy</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rinterface-memorymanagement.html"
                        title="next chapter">Memory management and garbage collection</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/rinterface.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rinterface-memorymanagement.html" title="Memory management and garbage collection"
             >next</a> |</li>
        <li class="right" >
          <a href="numpy.html" title="Numpy"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">rpy2 3.0.0-dev documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2008-2017, Laurent Gautier &amp; rpy2 contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>